pico-8 cartridge // http://www.pico-8.com
version 32
__lua__
-- hp bars
-- by sestrenexsis
-- https://github.com/sestrenexsis/workshop

box={}

function box:new(
	x,      -- x pos     : number
	y,      -- y pos     : number
	wd,     -- width     : number
	ht,     -- height    : number
	plt     -- palette   : number
	)
	if plt==nil then
		plt=1
	end
	local obj={
		x=x,
		y=y,
		wd=wd,
		ht=ht,
		plt=plt,
	}
	return setmetatable(
		obj,{__index=self}
	)
end

function box:render(
	p -- progress    : number
	)
	if p==nil then
		p=1.0
	end
	local rgt=self.x+p*self.wd
	rectfill(
		self.x,
		self.y,
		rgt,
		self.y+self.ht,
		self.plt
	)
end

function _init()
	_bar=box:new(1,8,102,6,1)
	_hpbar=box:new(2,9,100,4,2)
	_hplstbar=box:new(2,9,100,4,8)
	_hpmax=100
	_hp=flr(rnd(100))
	_hplst=_hp
end

function _update60()
	if btnp(‚ùé) then
		_hp=flr(rnd(100))
	end
	if _hp<_hplst then
		_hplst-=1
		if _hplst<_hp then
			_hplst=_hp
		end
	elseif _hp>_hplst then
		_hplst+=1
		if _hplst>_hp then
			_hplst=_hp
		end
	end
end

function _draw()
	cls()
	_bar:render()
	local p1=mid(0,_hp/_hpmax,1)
	local p2=mid(0,_hplst/_hpmax,1)
	if _hplst<_hp then
		_hplstbar.plt=8
		_hpbar.plt=14
		_hpbar:render(p1)
		_hplstbar:render(p2)
	elseif _hplst>_hp then
		_hpbar.plt=8
		_hplstbar.plt=2
		_hplstbar:render(p2)
		_hpbar:render(p1)
	else
		_hpbar.plt=8
		_hplstbar.plt=8
		_hpbar:render(p1)
	end
	print(_hp.." "..p1.." "..p2)
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
900100000000000000030001d44000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0001000007650016001660019600206002140028600000002d60000000326003660024600000003860000000386003860000000376003460000000306002c60027600246001f6001d6001c6001c6000000000000
000100001265000000166000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
